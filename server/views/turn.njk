{% extends  layout %}
{% block  content %}
  {%- from 'card.njk' import card -%}
  <h1>{{message}}</h1>
  <h2>It's {{player}}'s turn!</h2>
  {% if showCards == true %}
    <div class="table__cards">
        {{ card({value: tableCard.value, color: tableCard.color, in: 'in__left'})}}
        {{ card({url: url, value: "back", in: 'in__right'}) }}
    </div>
    <div class="card__collection">
      <ul>
        {% for mycard in cards %}
          {% set newCardUrl = [cardUrl, loop.index0] | join %}
          <li>{{ card({url: newCardUrl, value: mycard.value, color: mycard.color, fade: 1}) }}</li>
        {% endfor %}
      </ul>
    </div>
    <script>
      function fade(url) {
          var element = document.getElementById('card__' + url);
          element.classList.add("fade");
          setTimeout(function() {
            const tableCards = document.querySelectorAll('.table__cards .card__container');

            tableCards[0].querySelector('.card__image').classList.remove('in__left');
            tableCards[1].querySelector('.card__image').classList.remove('in__right');
            tableCards[0].querySelector('.card__image').classList.add('out__left');
            tableCards[1].querySelector('.card__image').classList.add('out__right');


            const boxes = document.querySelectorAll('.card__collection ul li .card__container .card__image');

            for (const box of boxes) {
              box.classList.add('out');
            }
            setTimeout(function() {
              window.location.href = url;
            }, 500);
          }, 500);
      }
    </script>
  {% else %}
    <div class="container__show">
      <form action="{{url}}" method="GET">
        <input type="submit" value="Show Cards" />
      </form>
    </div>
    <div class="card__collection"></div>
  {% endif %}
{% endblock %}